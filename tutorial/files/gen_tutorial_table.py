import pandas
import numpy as np
def ReturnResid(x):
    if 'N+' in x or 'C-' in x:
        return x[2:]
    else:
        return x[3:]
pKaMeans = []
pKaSTDs = []
Names = []
for i in range(1,6):
    df = pd.read_csv(f'tutorial/output/1AKI_md{i}/1AKI_md{i}_pka.csv')
    del df['Time [ps]']
    df.sort_index(axis=1,key=lambda x:[int(ReturnResid(i)) for i in x],inplace=True)
    for key in df.keys():
        Names.append(key)
        pKaMeans.append("{:.2f}".format(df[key].mean()))
        pKaSTDs.append("{:.2f}".format(df[key].std()))
        
pKaMeans = np.asarray(pKaMeans).reshape(5,-1)
pKaSTDs = np.asarray(pKaSTDs).reshape(5,-1)
Names = np.asarray(Names).reshape(5,-1)
tmp = np.char.add(pKaMeans,np.full(pKaMeans.shape,'±'))
pKaMeansSTDs = np.char.add(tmp,pKaSTDs)

OriginalTable = """N-term|-|-|7.41|7.45±0.07|7.43±0.08|7.44±0.06
LYS1|-|-|11.26|10.7±0.43|10.66±0.4|10.69±0.42
ARG5|-|-|12.20|12.14±0.07|12.17±0.06|12.16±0.05
GLU7|2.85±0.25|2.6±0.2|3.49|3.76±0.56|3.82±0.55|3.89±0.58
LYS13|-|-|10.64|11.25±0.43|11.35±0.36|11.36±0.35
ARG14|-|-|12.31|12.73±0.61|12.48±0.37|12.59±0.51
HIS15|5.36±0.07|5.5±0.2|6.40|5.99±0.32|5.85±0.23|5.91±0.29
ASP18|2.66±0.08|2.8±0.3|3.17|3.54±0.5|3.45±0.45|3.43±0.47
TYR20|-|-|9.25|9.44±0.49|9.43±0.45|9.31±0.42
ARG21|-|-|12.84|12.67±0.24|12.65±0.25|12.66±0.26
TYR23|-|-|9.89|9.98±0.22|10.04±0.22|10.01±0.23
LYS33|-|-|10.17|10.11±0.09|10.06±0.12|10.1±0.09
GLU35|6.20±0.10|6.1±0.4|5.55|6.06±0.47|4.42±0.9|6.0±0.49
ARG45|-|-|12.09|12.27±0.18|12.3±0.17|12.24±0.18
ASP48|<2.5|1.4±0.2|1.55|1.77±0.48|1.85±0.4|1.75±0.39
TYR53|-|-|11.65|11.13±0.52|10.79±0.48|10.75±0.5
ASP52|3.68±0.08|3.6±0.3|3.28|3.8±0.52|4.56±0.55|3.7±0.45
ARG61|-|-|13.33|13.06±0.43|12.97±0.36|13.03±0.35
ASP66|<2.0|1.2±0.2|-|1.64±0.4|1.58±0.38|1.51±0.37
ARG68|-|-|12.62|12.79±0.34|12.74±0.31|12.73±0.32
ARG73|-|-|12.29|12.27±0.15|12.48±0.59|12.25±0.14
ASP87|2.07±0.15|2.2±0.1|2.43|2.26±0.71|2.55±0.34|2.51±0.67
LYS96|-|-|10.10|10.12±0.18|10.21±0.18|10.16±0.2
LYS97|-|-|10.17|10.35±0.34|10.26±0.17|10.28±0.22
ASP101|4.09±0.07|4.5±0.1|4.09|3.41±0.46|3.24±0.52|3.35±0.42
ARG112|-|-|12.24|12.24±0.06|12.17±0.1|12.23±0.06
ARG114|-|-|12.23|12.25±0.08|13.01±0.5|12.25±0.08
LYS116|-|-|10.27|10.2±0.13|10.19±0.11|10.23±0.13
ASP119|3.20±0.09|3.5±0.3|2.87|2.55±0.51|2.43±0.32|2.41±0.3
ARG125|-|-|13.48|13.62±0.61|13.81±0.34|13.83±0.31
ARG128|-|-|12.42|12.6±0.39|12.52±0.25|12.5±0.17
C-term|2.75±0.02|2.7±0.2/3.9±0.1|3.21|2.55±0.61|2.43±0.57|2.5±0.54"""

for i, j in zip(OriginalTable.split('\n'), pKaMeansSTDs.T):
    print('|'.join(i.split('|')[:4])+'|'+'|'.join(j))